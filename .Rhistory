mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar))))
agg_modell_ar %>%
ggplot(aes(c_stracka)) %>%
geom_histogram()
agg_modell_ar %>%
ggplot(aes(c_stracka)) +
geom_histogram()
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka))
agg_modell_ar %>%
ggplot(aes(c_stracka)) +
geom_histogram(color = seg_stracka)
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka))
ggplot(agg_modell_ar, aes(x=position, y=kost, group = seg_stracka)) +
geom_line() +
geom_point() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar, aes(x=position, y=kost, fill = seg_stracka)) +
# geom_line() +
# geom_point() +
geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = factor(levels(factor(seg_stracka)[c("0","0-1500","1500-5000","5000-10000","10000+")])))
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = factor(levels(factor(seg_stracka)[c("0","0-1500","1500-5000","5000-10000","10000+")])))
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = factor(seg_stracka), levels = c("0","0-1500","1500-5000","5000-10000","10000+"))
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+")))
ggplot(agg_modell_ar, aes(x=position, y=kost, fill = seg_stracka)) +
# geom_line() +
# geom_point() +
geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggsave("pris_per_ar_mil_xc60_volvo_boxplot.png", width = 20, height = 20, units = "cm")
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
group_by(ar, seg_stracka) %>%
summarise(avg_pris = mean(kost))
View(agg_modell_ar)
ggplot(agg_modell_ar, aes(x=position, y=avg_pris, color = seg_stracka)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
group_by(position, seg_stracka) %>%
summarise(avg_pris = mean(kost))
ggplot(agg_modell_ar, aes(x=position, y=avg_pris, color = seg_stracka)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar, aes(x=position, y=avg_pris, color = seg_stracka)) +
geom_line(data = agg_modell_ar,aes(x = positionm, y = avg_pris, color = seg_stracka)) +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar, aes(x=position, y=avg_pris, color = seg_stracka)) +
geom_line(data = agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka)) +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
group_by(position, seg_stracka) %>%
summarise(avg_pris = mean(kost)) %>%
group_by(position,seg_stracka)
# 4. Per modell och ar och mil
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
group_by(position, seg_stracka) %>%
summarise(avg_pris = mean(kost)) %>%
group_by()
ggplot(agg_modell_ar, aes(x=position, y=avg_pris, color = seg_stracka)) +
geom_line(data = agg_modell_ar,aes(x = position, y = avg_pris,
color = seg_stracka)) +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar, aes(x=position, y=avg_pris, color = seg_stracka)) +
geom_line(data = agg_modell_ar,aes(x = position, y = avg_pris,
color = seg_stracka, group = 1)) +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
View(agg_modell_ar)
ggplot(agg_modell_ar) +
geom_line(aes(x = position, y = avg_pris, color = seg_stracka)) +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar) +
geom_line(aes(x = position, y = avg_pris, color = seg_stracka)) +
geom_point(aes(x = position, y = avg_pris, color = seg_stracka)) +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka,
group = position)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka,
group = seg_stracka)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggsave("pris_per_ar_mil_xc60_volvo_linegraph.png", width = 20, height = 20, units = "cm")
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka,
linetype = as.factor(drivmedel),
group = seg_stracka)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+")))
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka,
linetype = as.factor(drivmedel),
group = seg_stracka)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = kost, color = seg_stracka,
linetype = as.factor(drivmedel),
group = seg_stracka)) +
# geom_line() +
# geom_point() +
geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
agg_drivmedel <- c_tot %>%
group_by(drivmedel) %>%
summarise(n = n())
View(agg_drivmedel)
agg_drivmedel <- c_tot %>%
group_by(drivmedel) %>%
summarise(n = n()) %>%
arrange(desc(n))
View(agg_drivmedel)
c("Diesel","Bensin","Miljöbränsle/Hybrid","El")
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
filter(drivmedel %in% c("Diesel","Bensin","Miljöbränsle/Hybrid","El")) %>%
group_by(position, seg_strackadrivmedel) %>%
summarise(avg_pris = mean(kost))
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
filter(drivmedel %in% c("Diesel","Bensin","Miljöbränsle/Hybrid","El")) %>%
group_by(position, seg_stracka, drivmedel) %>%
summarise(avg_pris = mean(kost))
c("Diesel","Bensin","Miljöbränsle/Hybrid","El")
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+")))
View(agg_modell_ar)
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
mutate(seg_stracka = as.factor(seg_stracka)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
filter(!drivmedel %in% c("Diesel","Bensin","Miljöbränsle/Hybrid","El")) %>%
group_by(position, seg_stracka, drivmedel) %>%
summarise(avg_pris = mean(kost))
View(agg_modell_ar)
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
filter(!drivmedel %in% c("Diesel","Bensin","Miljöbränsle/Hybrid","El")) %>%
mutate(seg_stracka = as.factor(seg_stracka), drivmedel = as.factor(drivmedel)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
group_by(position, seg_stracka, drivmedel) %>%
summarise(avg_pris = mean(kost))
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka,
linetype = drivmedel)) +
# geom_line() +
# geom_point() +
geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, fill = seg_stracka,
linetype = drivmedel)) +
# geom_line() +
# geom_point() +
geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
filter(!drivmedel %in% c("Diesel","Bensin","Miljöbränsle/Hybrid","El")) %>%
mutate(seg_stracka = as.factor(seg_stracka), drivmedel = as.factor(drivmedel)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+")))
ggplot(agg_modell_ar,aes(x = position, y = kost, fill = seg_stracka,
linetype = drivmedel)) +
#geom_line() +
#geom_point() +
geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = kost, fill = seg_stracka,
color = drivmedel)) +
#geom_line() +
#geom_point() +
geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = kost, color = seg_stracka,
linetype = drivmedel)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
agg_modell_ar <- c_tot %>%
filter(c_marke == "volvo") %>%
filter(ar %in% c("00","01","02","03","04","05","06","07","08","09","10",
"11","12","13","14","15","16","17","18","19"),
c_modell == "xc60") %>%
mutate(ar = as.factor(ar)) %>%
mutate(position = factor(ar, levels = rev(levels(ar)))) %>%
mutate(seg_stracka = ifelse(c_stracka == 0, "0",
ifelse(c_stracka <= 1500, "0-1500",
ifelse(c_stracka <= 5000, "1500-5000",
ifelse(c_stracka <= 10000, "5000-10000", "10000+"))))) %>%
filter(!drivmedel %in% c("Diesel","Bensin","Miljöbränsle/Hybrid","El")) %>%
mutate(seg_stracka = as.factor(seg_stracka), drivmedel = as.factor(drivmedel)) %>%
mutate(seg_stracka = factor(seg_stracka, levels = c("0","0-1500","1500-5000","5000-10000","10000+"))) %>%
group_by(position, seg_stracka, drivmedel) %>%
summarise(avg_pris = mean(kost))
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka,
linetype = drivmedel)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka,
linetype = drivmedel, group = seg_stracka)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka,
linetype = drivmedel, group = c("seg_stracka", "drivmedel"))) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank())
ggplot(agg_modell_ar,aes(x = position, y = avg_pris, color = seg_stracka, group = seg_stracka)) +
geom_line() +
geom_point() +
#geom_boxplot() +
labs(x = "", y = "Genomsnittspris", title = "Pris for volvo XC60") +
theme(plot.title = element_text(hjust = 0.5),
axis.line = element_blank(),
plot.background = element_blank()) +
facet_wrap(~drivmedel)
ggsave("pris_per_ar_mil_xc60_volvo_linegraph_drivmedel.png", width = 20, height = 20, units = "cm")
